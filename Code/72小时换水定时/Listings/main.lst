C51 COMPILER V9.52.0.0   MAIN                                                              10/22/2022 16:10:52 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Keil_vn\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main.lst) TABS(2) OBJE
                    -CT(.\Objects\main.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "Delay.h"
   3          #include "LCD1602.h"
   4          #include "Timer0.h"
   5          #include "delaytime10us.h"
   6          #include "MotorRun.h"
   7          #include "OneWire.h"
   8          #include "DS18B20.h"
   9          #include <intrins.h>
  10          
  11          sbit LED0=P2^0;
  12          sbit LED1=P2^1;
  13          
  14          sbit TRIG=P1^6;
  15          sbit ECHO=P1^7;
  16          
  17          sbit LCD_E=P2^7;
  18          sbit LCD_RW=P2^5;
  19          sbit LCD_RS=P2^6;
  20          
  21          //unsigned char code word1[]="temp";//0--15
  22          //unsigned char code word2[]="High=       cm";//0--15
  23          unsigned char code word3[]="0123456789";
  24          
  25          unsigned int Set=40;//Â¾Ã Ã€Ã«Ã–Âµ,ÂµÂ¥ÃÂ»cm
  26          unsigned int Now;
  27          unsigned int count_T0=0,count_1ms,miao=0;
  28          unsigned int High_Time;
  29          unsigned char flag;
  30          //********å‡½æ•°*********
  31          void lcd_write_com(unsigned char com);
  32          void lcd_write_data(unsigned char dat);
  33          void lcdInit();
  34          void display_LCD(unsigned char hang,unsigned char lie,unsigned dat);
  35          
  36          void Timer0_Init();
  37          
  38          void delayms(unsigned char t);
  39          void scan_key();
  40          unsigned int WAVE();
  41          void display_string();
  42          void Timer_delay(unsigned int BS);
  43          
  44          
  45          
  46          
  47          float T;
  48          
  49          //************************ä¸»å‡½æ•°************************
  50          void main()
  51          {
  52   1          unsigned char bai,shi,ge;
  53   1        lcdInit();
  54   1        display_string();//ÃÃ”ÃŠÂ¾Â¿ÂªÃŠÂ¼ÂµÃ„Ã—Ã–Ã„Â¸
C51 COMPILER V9.52.0.0   MAIN                                                              10/22/2022 16:10:52 PAGE 2   

  55   1        
  56   1        LCD_Init();
  57   1        Timer0Init();
  58   1        
  59   1        DS18B20_ConvertT();   //ä¸Šç”µå…ˆè½¬æ¢ä¸€æ¬¡æ¸©åº¦ï¼Œé˜²æ­¢ç¬¬ä¸€æ¬¡è¯»æ•°æ®é”™è¯¯
  60   1        Delay(100);     //ç­‰å¾…è½¬æ¢å®Œæˆ
  61   1        LCD_Init();
  62   1        LCD_ShowString(1,1,"Temp:");
  63   1        LCD_ShowString(1,15,"C");
  64   1        LCD_ShowString(2,1,"High:");
  65   1        LCD_ShowString(2,15,"cm");
  66   1        //LCD_ShowString(2,1,"High:");
  67   1        while(1)
  68   1        {
  69   2          DS18B20_ConvertT(); //è½¬æ¢æ¸©åº¦
  70   2          T=DS18B20_ReadT();  //è¯»å–æ¸©åº¦
  71   2          if(T<0)       //å¦‚æœæ¸©åº¦å°äº0
  72   2          {
  73   3            LCD_ShowChar(1,7,'-');  //æ˜¾ç¤ºè´Ÿå·
  74   3            T=-T;     //å°†æ¸©åº¦å˜ä¸ºæ­£æ•°
  75   3          }
  76   2          else        //å¦‚æœæ¸©åº¦å¤§äºç­‰äº0
  77   2          {
  78   3            LCD_ShowChar(1,7,'+');  //æ˜¾ç¤ºæ­£å·
  79   3          }
  80   2          LCD_ShowNum(1,8,T,2);   //æ˜¾ç¤ºæ¸©åº¦æ•´æ•°éƒ¨åˆ†
  81   2          LCD_ShowChar(1,10,'.');   //æ˜¾ç¤ºå°æ•°ç‚¹
  82   2          LCD_ShowNum(1,11,(unsigned long)(T*10000)%10000,3);//æ˜¾ç¤ºæ¸©åº¦å°æ•°éƒ¨åˆ†
  83   2          
  84   2          scan_key();
  85   2          
  86   2          
  87   2          High_Time=WAVE();//Â³Â¬Ã‰Ã¹Â²Â¨
  88   2          
  89   2          Now=(int)(High_Time*0.0175);
  90   2        
  91   2          
  92   2          bai=Now/100%10;
  93   2          shi=Now/10%10;
  94   2          ge=Now%10;
  95   2          
  96   2          if(bai!=0)
  97   2          {
  98   3        
  99   3           delayms(1);
 100   3          }
 101   2          display_LCD(1,7,word3[shi]);
 102   2          delayms(1);
 103   2          display_LCD(1,8,word3[ge]);
 104   2          delayms(1);
 105   2        }
 106   1      }
 107          
 108          
 109          void Timer_delay(unsigned int BS)//T1Ã‘Ã“ÃŠÂ±0.5ms
 110          {
 111   1        unsigned int k;
 112   1        for(k=0;k<BS;k++)
 113   1        {
 114   2          TH1=(65536-100)/256;
 115   2          TL1=(65536-100)%256;
 116   2          while(TF1==0);
C51 COMPILER V9.52.0.0   MAIN                                                              10/22/2022 16:10:52 PAGE 3   

 117   2          TF1=0;
 118   2        }
 119   1      }
 120          //*Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÃÃ”ÃŠÂ¾Â¿ÂªÃŠÂ¼ÂµÃ„Ã—Ã–Ã„Â¸Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡Âª*/
 121          void display_string()
 122          {
 123   1        unsigned m,n;
 124   1      //  for(m=0;m<4;m++)
 125   1      //  {
 126   1      //    display_LCD(0,m,word1[m]);
 127   1      //    delayms(1);
 128   1      //  } 
 129   1          
 130   1      //  for(n=0;n<16;n++)
 131   1      //  {
 132   1      //    display_LCD(1,n,word2[n]);
 133   1      //    delayms(1);
 134   1      //  }   
 135   1      }
*** WARNING C280 IN LINE 123 OF main.c: 'm': unreferenced local variable
*** WARNING C280 IN LINE 123 OF main.c: 'n': unreferenced local variable
 136          /*Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ³Â¬Ã‰Ã¹Â²Â¨Â¼Ã†Ã‹Ã£ÃŠÂ±Â¼Ã¤Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡Âª
             -Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡Âª*/
 137          unsigned int WAVE()
 138          {
 139   1          unsigned int result;
 140   1          unsigned char p;
 141   1          TRIG=0;
 142   1          _nop_();//1ÃÂ¢ÃƒÃ«
 143   1          TRIG=1;
 144   1          for(p=0;p<10;p++);//Â´Ã³Ã“Ãš10us
 145   1      
 146   1          TRIG=0;
 147   1          while(ECHO==0);//ÂµÃˆÂ¸ÃŸÂµÃ§Ã†Â½Ã€Â´
 148   1          Timer0_Init();//Â¿ÂªÃŠÂ¼Â¼Ã†ÃŠÂ±Â¼Ã‡Â¸ÃŸÂµÃ§Ã†Â½ÃŠÂ±Â¼Ã¤Â¼Â´Â³Â¬Ã‰Ã¹Â²Â¨Â·Â¢Ã‰Ã¤--Â·ÂµÂ»Ã˜ÃŠÂ±Â¼Ã¤
 149   1          while(ECHO)
 150   1          {
 151   2             if((TH0>0x8c)|| (TH0==0x8c&&TL0>0xa0))break;
 152   2          }
 153   1          TR0=0;
 154   1          //18us=18000ms=4650H  ;100us--18msÃ“ÃÃÂ§    Â³Â¬Â¹Ã½36msÃÃÃÂ§ 36ms=8cA0
 155   1           if((TH0<0x46)|| (TH0==0x46&&TL0<=0x50))
 156   1           {
 157   2             result=(TH0<<8)+TL0;
 158   2             return result;
 159   2           }
 160   1          else return 0;
 161   1      }
 162          
 163          /*Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªLCDÂ³ÃµÃŠÂ¼Â»Â¯Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ
             -¡ÂªÂ¡ÂªÂ¡ÂªÂ¡Âª*/
 164          void lcdInit()
 165          {
 166   1        lcd_write_com(0x38);//Ã—Ã–Â·Ã»ÃÂª5*7ÂµÃ£Ã•Ã³
 167   1        lcd_write_com(0x0c); //ÃÃ”ÃŠÂ¾Â¿Âª Â¹Ã¢Â±ÃªÂ¹Ã˜ Ã‰ÃÃ‹Â¸Â¹Ã˜
 168   1        lcd_write_com(0x06);//ÃÂ´ÃˆÃ«ÃŠÃ½Â¾ÃÂºÃ³Â¹Ã¢Â±ÃªÃ“Ã’Ã’Ã†Ã’Â»ÃÂ» ÃÃ”ÃŠÂ¾Ã†ÃÂ²Â»Â¶Â¯
 169   1        lcd_write_com(0x01);//Ã‡Ã¥Ã†Ã
 170   1        lcd_write_com(0x80);//Ã‰Ã¨Ã–ÃƒÃŠÃ½Â¾ÃÃ–Â¸Ã•Ã«Ã†Ã°ÂµÃ£
 171   1      }
 172          
 173          /**Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªLCDÃÂ´ÃƒÃ¼ÃÃ®Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡Âª
             -Â¡ÂªÂ¡ÂªÂ¡Âª*/
C51 COMPILER V9.52.0.0   MAIN                                                              10/22/2022 16:10:52 PAGE 4   

 174          void lcd_write_com(unsigned char com)
 175          {
 176   1        LCD_E=0;
 177   1        LCD_RS=0;//ÃƒÃ¼ÃÃ®
 178   1        LCD_RW=0;//ÃÂ´ÃˆÃ«
 179   1        P0=com;
 180   1        delayms(1);
 181   1        LCD_E=1;//ÃÂ´ÃˆÃ«ÃŠÂ±ÃÃ²
 182   1        delayms(1);
 183   1        LCD_E=0;
 184   1      
 185   1      }
 186          
 187          /*Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªLCDÃÂ´ÃŠÃ½Â¾ÃÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ
             -¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡Âª*/
 188          void lcd_write_data(unsigned char dat)
 189          {
 190   1        LCD_E=0;
 191   1        LCD_RW=0;//ÃÂ´ÃˆÃ«
 192   1        LCD_RS=1;//ÃŠÃ½Â¾Ã
 193   1        P0=dat;
 194   1        delayms(1);
 195   1        LCD_E=1;
 196   1        delayms(1);
 197   1        LCD_E=0;
 198   1      }
 199          //*Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÃ’ÂºÂ¾Â§Ã†ÃÃÃ”ÃŠÂ¾Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡Â
             -ªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡Âª*/
 200          void display_LCD(unsigned char hang,unsigned char lie,unsigned value) 
 201          {
 202   1        if(hang==0)
 203   1        {
 204   2          lcd_write_com(0x80+lie);
 205   2        }
 206   1        if(hang==1)
 207   1        {
 208   2          lcd_write_com(0xc0+lie);
 209   2        }
 210   1        lcd_write_data(value);
 211   1      }
 212          
 213          
 214          /*Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¶Â¨ÃŠÂ±Ã†Ã·Â³ÃµÃŠÂ¼Â»Â¯Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡Âª*///T1Ã‘Ã“ÃŠÂ±Â£
             -Â¬T0Ã–ÃÂ¶Ã
 215          void Timer0_Init()
 216          {
 217   1        //count_T0=0;
 218   1        //miao=0;
 219   1        TMOD=0x11;
 220   1        TH0=0;
 221   1        TL0=0;
 222   1        //ET0=1;
 223   1        TR0=1;TR1=1;
 224   1        //EA=1;
 225   1      }
 226          void Timer0() interrupt 1
 227          {
 228   1        TH0=0;
 229   1        TL0=0;
 230   1      
 231   1      }
 232          
C51 COMPILER V9.52.0.0   MAIN                                                              10/22/2022 16:10:52 PAGE 5   

 233          //*Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ°Â´Â¼Ã¼Ã‰Â¨ÃƒÃ¨Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡Â
             -ªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡Âª*/
 234          void scan_key()
 235          {
 236   1      
 237   1        P1=0xff;
 238   1        if(P1!=0xff)delayms(10);
 239   1        //key_up=0;
 240   1        if(P1!=0xff)
 241   1        {
 242   2          switch(P1&0xff)
 243   2          {
 244   3              case 0xfe :Set=Set+10;LED0=0;break;//key_up  p1.0
 245   3              case 0xfd :Set=Set-10;break;//key_dn  p1.1
 246   3          }
 247   2          while(P1!=0xff);
 248   2        }
 249   1      }
 250          //*Â¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡Â
             -ªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡ÂªÂ¡Âª*/
 251          void delayms(unsigned char t)
 252          {
 253   1        unsigned i,j;
 254   1        for(i=0;i<t;i++)
 255   1           for(j=0;j<120;j++);
 256   1      }
 257          
 258          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    688    ----
   CONSTANT SIZE    =     28    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     17      10
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)

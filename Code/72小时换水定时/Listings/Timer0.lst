C51 COMPILER V9.52.0.0   TIMER0                                                            10/22/2022 15:57:39 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE TIMER0
OBJECT MODULE PLACED IN .\Objects\Timer0.obj
COMPILER INVOKED BY: D:\Keil_vn\C51\BIN\C51.EXE Timer0.c BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\Timer0.lst) TABS(2) 
                    -OBJECT(.\Objects\Timer0.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "MotorRun.h"
   3          /**
   4            * @brief  定时器0初始化，1毫秒@12.000MHz
   5            * @param  无
   6            * @retval 无
   7            */
   8            
   9            
  10          unsigned char Sec=0,Min=0,Hour=0;
  11          int zhuanFlag=0;
  12          void Timer0Init(void)
  13          {
  14   1        TMOD &= 0xF0;   //设置定时器模式
  15   1        TMOD |= 0x01;   //设置定时器模式
  16   1        TL0 = 0x18;   //设置定时初值
  17   1        TH0 = 0xFC;   //设置定时初值
  18   1        TF0 = 0;    //清除TF0标志
  19   1        TR0 = 1;    //定时器0开始计时
  20   1        ET0=1;
  21   1        EA=1;
  22   1        PT0=0;
  23   1      }
  24          
  25          /*定时器中断函数模板
  26          void Timer0_Routine() interrupt 1
  27          {
  28            static unsigned int T0Count;
  29            TL0 = 0x18;   //设置定时初值
  30            TH0 = 0xFC;   //设置定时初值
  31            T0Count++;
  32            if(T0Count>=1000)
  33            {
  34              T0Count=0;
  35              
  36            }
  37          }
  38          */
  39          void Timer0_Routine() interrupt 1
  40          {
  41   1        static unsigned int T0Count,HourCount;
  42   1        TL0 = 0x18;   //设置定时初值
  43   1        TH0 = 0xFC;   //设置定时初值
  44   1        T0Count++;   //1000次计数
  45   1            
  46   1            if(T0Count>=1000) //定时器分频，1s
  47   1          {
  48   2            T0Count=0;
  49   2            Sec++;      //1秒到，Sec自增
  50   2            if(Sec>=60)
  51   2            {
  52   3              Sec=0;    //60秒到，Sec清0，Min自增
  53   3              Min++;
  54   3              if(Min>=60)
C51 COMPILER V9.52.0.0   TIMER0                                                            10/22/2022 15:57:39 PAGE 2   

  55   3              {
  56   4                Min=0;  //60分钟到，Min清0，Hour自增
  57   4                Hour++;
  58   4                if(Hour>=24)
  59   4                {
  60   5                  Hour=0; //24小时到，Hour清0
  61   5                  HourCount++;
  62   5              }
  63   4            }
  64   3          }
  65   2          }
  66   1          if(HourCount==3)
  67   1          {
  68   2            if(zhuanFlag == 0)
  69   2            {
  70   3              MotorRun(4389/2,1,100);         //  nangle=4096ÎªÒ»È¦£» drct=0ÎªÄæÊ±Õë×ª¶¯£¬drct=1Î
             -Ë³Ê±Õë×ª¶¯£»  speed×ªËÙ75`400£»
  71   3              zhuanFlag++;
  72   3            }else 
  73   2            {
  74   3              MotorRun(4389/2,0,100);         //  nangle=4096ÎªÒ»È¦£» drct=0ÎªÄæÊ±Õë×ª¶¯£¬drct=1Î
             -Ë³Ê±Õë×ª¶¯£»  speed×ªËÙ75`400£»
  75   3              zhuanFlag =0;
  76   3              HourCount =0;
  77   3            }
  78   2          }
  79   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    212    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      9    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
